<macros>
    <xml name="requirement">
        <requirement type="package" version="4.3.1t">snpeff</requirement>
    </xml>
  <xml name="stdio">
    <stdio>
        <exit_code range=":-1"  level="fatal" description="Error: Cannot open file" />
        <exit_code range="1:"  level="fatal" description="Error" />
    </stdio>
  </xml>
  <xml name="version_command">
    <version_command><![CDATA[
snpEff -version
    ]]></version_command>
  </xml>
  <token name="@wrapper_version@">4.3+T</token>
  <token name="@snpeff_version@">SnpEff4.3</token>
  <token name="@snpeff_database_url@">https://sourceforge.net/projects/snpeff/files/databases/v4_3/</token>
  <token name="@java_options@">-Xmx\${GALAXY_MEMORY_MB:-8192}m</token>
  <token name="@external_documentation@">


-------

To learn more about snpEff read its manual at http://snpeff.sourceforge.net/SnpEff_manual.html
  </token>
  <token name="@snpeff_in_galaxy_info@">

-------

.. class:: warningmark

**Using SnpEff in Galaxy: A few points to remember**

SnpEff relies on specially formatted databases to generate annotations. It will not work without them. There are several ways in which these databases can be obtained.

**Galaxy-maintained databases**

SnpEff has its own databases and rely on the use of specific reference genomes in order to output accurate annotations. Galaxy admins thus link built-in references to specific SnpEff databases. Many standard (e.g., human, mouse, *Drosophila*) references are likely linked to related SnpEff databases within a given Galaxy instance. You should be able to see them listed in the **Galaxy-maintained** / **Genome** drop-down of **SnpEff eff** tool.

If you *do not see them* keep reading...

**Download pre-built SnpEff databases**

The SnpEff project generates large numbers of pre-built databases. These are available at @SNPEFF_DATABASE_URL@ and can be downloaded using the `SnpEff download` galaxy tool. To identify and retrieve the appropriate database, follow these steps:

  #. Use the **SnpEff databases** tool to generate a list of existing databases. Note the **genome version** of the database you need.
  #. Use the **SnpEff download** tool to download the database and save it in your history.
  #. Finally, use **SnpEff eff** by choosing the downloaded database from the history using *History (downloaded using the "SnpEff download" tool)* option of the **SnpEff database source** parameter.

Alternatively, you can specify the **genome version** directly in **SnpEff eff** using the *SnpEff-maintained* option (again, under the **SnpEff database source** parameter). The SnpEff tool has access to copies of the SnpEff databases (linked or unlinked to galaxy's built-in references). If any required SnpEff databases are missing in the *SnpEff databases* output, check the **Download &amp; install if not present** checkbox. In this case snpEff will download the database and add it to the SnpEff-maintained data before performing annotation. It will not be saved in your history. It is critical in this case, to be sure you are selecting the database that matches the reference you used.

**Create your own database**

In cases when you are dealing with any genomes for which a pre-built SnpEff database does not exist, it is possible to create the database yourself. For this you need:

 #. A downloaded Genbank record corresponding to your genome of interest from NCBI or use annotations in GFF format accompanied by the corresponding genome in FASTA format.
 #. Use **SnpEff build** to create the database.
 #. Use the database in **SnpEff eff** (using *History (custom-built using the "SnpEff build" tool)* option for the **SnpEff database source** parameter).

Creating a custom database has one major advantage. It guaranteess that you will not have any issues related to reference sequence naming -- the most common source of SnpEff errors.

</token>



  <xml name="citations">
      <citations>
        <citation type="doi">10.4161/fly.19695</citation>
        <yield />
      </citations>
  </xml>
</macros>
